<h2 mat-dialog-title>Nova Application</h2>

<mat-dialog-content>
  <form [formGroup]="applicationForm" class="application-form">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nome da Application</mat-label>
      <input 
        matInput 
        formControlName="name"
        placeholder="Ex: payment-service"
        required>
      <mat-icon matPrefix>apps</mat-icon>
      @if (applicationForm.get('name')?.hasError('required') && applicationForm.get('name')?.touched) {
        <mat-error>Nome é obrigatório</mat-error>
      }
      @if (applicationForm.get('name')?.hasError('minlength')) {
        <mat-error>Nome deve ter no mínimo 3 caracteres</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Time Responsável</mat-label>
      <input 
        matInput 
        formControlName="ownerTeam"
        placeholder="Ex: Team Backend"
        required>
      <mat-icon matPrefix>group</mat-icon>
      @if (applicationForm.get('ownerTeam')?.hasError('required') && applicationForm.get('ownerTeam')?.touched) {
        <mat-error>Time responsável é obrigatório</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>URL do Repositório</mat-label>
      <input 
        matInput 
        formControlName="repoUrl"
        placeholder="Ex: https://github.com/company/repo"
        required>
      <mat-icon matPrefix>link</mat-icon>
      @if (applicationForm.get('repoUrl')?.hasError('required') && applicationForm.get('repoUrl')?.touched) {
        <mat-error>URL do repositório é obrigatória</mat-error>
      }
      @if (applicationForm.get('repoUrl')?.hasError('pattern')) {
        <mat-error>URL inválida</mat-error>
      }
    </mat-form-field>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button 
    mat-button 
    mat-dialog-close
    [disabled]="saving">
    Cancelar
  </button>
  <button 
    mat-raised-button 
    color="primary"
    (click)="onSubmit()"
    [disabled]="applicationForm.invalid || saving">
    @if (saving) {
      <mat-spinner diameter="20" class="button-spinner"></mat-spinner>
      <span>Criando...</span>
    } @else {
      <ng-container>
        <mat-icon>add</mat-icon>
        <span>Criar Application</span>
      </ng-container>
    }
  </button>
</mat-dialog-actions>