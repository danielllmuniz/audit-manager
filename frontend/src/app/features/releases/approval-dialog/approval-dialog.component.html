<h2 mat-dialog-title>
  @if (isApproval) {
    <mat-icon color="primary" class="title-icon">check_circle</mat-icon>
    <span>Aprovar Release</span>
  } @else {
    <mat-icon color="warn" class="title-icon">cancel</mat-icon>
    <span>Rejeitar Release</span>
  }
</h2>

<mat-dialog-content>
  <div class="release-info">
    <mat-card>
      <mat-card-content>
        <div class="info-row">
          <span class="label">Application:</span>
          <span class="value">{{ release.application_name }}</span>
        </div>
        <div class="info-row">
          <span class="label">Versão:</span>
          <span class="value">{{ release.version }}</span>
        </div>
        <div class="info-row">
          <span class="label">Ambiente:</span>
          <mat-chip class="env-chip">{{ release.env }}</mat-chip>
        </div>
        <div class="info-row">
          <span class="label">Status Atual:</span>
          <mat-chip [class]="'status-chip status-' + getStatusClass()">
            {{ getStatusLabel() }}
          </mat-chip>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <form [formGroup]="approvalForm" class="approval-form">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Notas / Comentários</mat-label>
      <textarea 
        matInput 
        formControlName="notes"
        rows="4"
        [placeholder]="isApproval ? 'Adicione comentários sobre a aprovação...' : 'Explique o motivo da rejeição...'">
      </textarea>
      <mat-icon matPrefix>comment</mat-icon>
      <mat-hint>{{ approvalForm.get('notes')?.value?.length || 0 }} / 500 caracteres</mat-hint>
    </mat-form-field>

    @if (!isApproval) {
      <mat-card class="warning-card">
        <mat-card-content>
          <div class="warning-section">
            <mat-icon color="warn">warning</mat-icon>
            <div class="warning-text">
              <strong>Atenção!</strong>
              <p>Ao rejeitar este release, o processo será encerrado e será necessário criar um novo release.</p>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    }
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button 
    mat-button 
    mat-dialog-close
    [disabled]="saving">
    Cancelar
  </button>
  <button 
    mat-raised-button 
    [color]="isApproval ? 'primary' : 'warn'"
    (click)="onSubmit()"
    [disabled]="saving">
    @if (saving) {
      <mat-spinner diameter="20" class="button-spinner"></mat-spinner>
      <span>Processando...</span>
    } @else {
      @if (isApproval) {
        <mat-icon>check_circle</mat-icon>
        <span>Aprovar</span>
      } @else {
        <mat-icon>cancel</mat-icon>
        <span>Rejeitar</span>
      }
    }
  </button>
</mat-dialog-actions>